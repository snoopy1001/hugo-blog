---
title: "[笔记] sklearn 填充缺失值"
date: 2020-10-27
lastmod: 2020-10-27
draft: false
tags: ["ML", "sklearn", "缺失值"]
categories: ["ML"]
---

## 介绍

[`SimpleImputer`](https://www.studyai.cn/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer) 类提供了估算缺失值的基本策略。缺失值可以用提供的常量值来计算， 或使用缺失值所在的每一列的统计数据(平均值、中位数或最频繁)。该类还允许不同的缺失值编码。

## 官方文档

 [sklearn.impute.SimpleImputer](https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html) 

一般形式 

class sklearn.impute.SimpleImputer(missing_values=nan, strategy='mean', fill_value=None, verbose=0, copy=True, add_indicator=False)

参数说明

类型：string（字符串），可选（默认=“ mean”）

- 如果是“mean”，则使用每列中的平均值替换缺失值。只能与数字数据一起使用。
- 如果为“median”，则使用每列中的中位数替换缺失值。只能与数字数据一起使用。
- 如果为“most_frequent”，则使用每列中最频繁的值替换。可以与字符串或数字数据一起使用。
- 如果为“constant”，则将缺失的值替换为fill _value。可以与字符串或数字数据一起使用。

Notes

Columns which only contained missing values at [`fit`](https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer.fit) are discarded upon [`transform`](https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer.transform) if strategy is not “constant”.



| Methods                                                      |                                       |
| ------------------------------------------------------------ | ------------------------------------- |
| [`fit`](https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer.fit)(X[, y]) | Fit the imputer on X.                 |
| [`fit_transform`](https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer.fit_transform)(X[, y]) | Fit to data, then transform it.       |
| [`get_params`](https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer.get_params)([deep]) | Get parameters for this estimator.    |
| [`set_params`](https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer.set_params)(**params) | Set the parameters of this estimator. |
| [`transform`](https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html#sklearn.impute.SimpleImputer.transform)(X) | Impute all missing values in X.       |

## 官方示例

```python
>>> import numpy as np
>>> from sklearn.impute import SimpleImputer
>>> imp_mean = SimpleImputer(missing_values=np.nan, strategy='mean')
>>> imp_mean.fit([[7, 2, 3], [4, np.nan, 6], [10, 5, 9]])
SimpleImputer()
>>> X = [[np.nan, 2, 3], [4, np.nan, 6], [10, np.nan, 9]]
>>> print(imp_mean.transform(X))
[[ 7.   2.   3. ]
 [ 4.   3.5  6. ]
 [10.   3.5  9. ]]
```

下面的代码片段演示如何使用包含缺失值的列(axis 0)的平均值替换丢失的值，编码为 `np.nan` 

```python
>>> import numpy as np
>>> from sklearn.impute import SimpleImputer
>>> imp = SimpleImputer(missing_values=np.nan, strategy='mean')
>>> imp.fit([[1, 2], [np.nan, 3], [7, 6]])       
SimpleImputer(copy=True, fill_value=None, missing_values=nan, strategy='mean', verbose=0)
>>> X = [[np.nan, 2], [6, np.nan], [7, 6]]
>>> print(imp.transform(X))           
[[4.          2.        ]
 [6.          3.666...]
 [7.          6.        ]]
```

## 参考

- sklearn.impute.SimpleImputer https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html
- Imputation of missing values https://scikit-learn.org/stable/modules/impute.html#impute
- 缺失值处理 https://www.studyai.cn/modules/impute.html
- sklearn: 缺失值插补 https://tsinghua-gongjing.github.io/posts/sklearn_imputation.html
- 单变量插补 https://sklearn.apachecn.org/docs/master/41.html?h=imputer
- 1

